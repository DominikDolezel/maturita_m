\section{Kuželosečky}
\begin{definition}
    Nechť je v $\mathbb E_2$ dána afinní soustava souřadnic $\left < P,\vec e_1, \vec e_2 \right > $.
    Nechť
    \begin{equation}\label{kuzelosec}
        a_{11}x^2+2a_{12}xy+a_{22}y^2+2a_{13}x+2a_{23}y+a_{33}=0,
    \end{equation}
    kde $a_{ij}\in \mathbb R, a_{11}^2 + a_{22}^2 + a_{33}^2\ne 0.$ Pak množinu všech
    bodů $[x,y] \in \mathbb E_2$, jejichž souřadnice vyhovují rovnici \ref{kuzelosec},
    nazýváme \textbf{kuželosečkou}. Rovnici \ref{kuzelosec} nazýváme \textbf{rovnicí kuželosečky}.
\end{definition}

\begin{definition}
    Nechť $k$ je kuželosečka s rovnicí \ref{kuzelosec}. Pak matici
    $$
        A = \begin{pmatrix}
            a_{11} & a_{12} & a_{13} \\
            a_{12} & a_{22} & a_{23} \\
            a_{13} & a_{23} & a_{33}
        \end{pmatrix}
    $$
    nazýváme \textbf{maticí kuželosečky} $k$.
\end{definition}

\begin{priklad}
Napište matici kuželosečky $x^2-2xy+3y+1=0.$
\end{priklad}
\begin{reseni}
Z definice je
$$
A = \begin{pmatrix}
    1 &-1 &0\\
    -1 &0 &\frac{3}{2}\\
    0 &\frac{3}{2} &1
\end{pmatrix}.
$$
\end{reseni}

\begin{pozn}
    Rovnici kuželosečky lze zapsat pomocí její matice $A$ jako
    $$\begin{pmatrix}
        x & y & 1
    \end{pmatrix}\cdot A \cdot \begin{pmatrix}
        x\\
        y\\
        1
    \end{pmatrix}=0.$$
\end{pozn}

\begin{definition}
    Nechť $k$ o rovnici \ref{kuzelosec} je kuželosečka. Každou kuželosečku lze
    vhodnou transformací soustavy souřadnic převést na jednu z následujících
    tvarů, které nazýváme \textbf{kanonickými rovnicemi kuželosečky}.
    \begin{enumerate}[$i.$]
    \item $\frac{x^2}{a^2} + \frac{y^2}{b^2}=1$ (elipsa, $a,b$ jsou její poloosy),
   	\item $\frac{x^2}{a^2} + \frac{y^2}{b^2}=-1$ (imaginární elipsa),
   	\item $\frac{x^2}{a^2} - \frac{y^2}{b^2}=1$ (hyperbola, $a,b$ jsou její poloosy),
   	\item $y^2=2px, p>0$ (parabola, $p$ je její parametr),
   	\item $y^2 = k^2x^2, k>0$ (dvě různoběžky),
   	\item $y^2 = -k^2x^2, k>0$ (bod),
   	\item $y^2 = r^2, r>0$ (dvě různé rovnoběžky),
   	\item $y^2 = -r^2, r>0$ (prázdná množina),
   	\item $y^2=0$ (dvojná přímka).
    \end{enumerate}
\end{definition}

\begin{priklad}
Je dána kuželosečka $4x^2+9y^2-16x+54y+61=0.$ Určete, jestli je to elipsa.
\end{priklad}

\begin{reseni}
Doplněním na čtverec pro $x$ a pro $y$.
\end{reseni}







\begin{definition}
    Kuželosečka je \textbf{singulární}, jestliže determinant její matice je nulový.
    V opačném případě je \textbf{regulární}.
\end{definition}

\begin{definition}
    Vyhovuje-li rovnici kuželosečky alespoň jeden bod, je to kuželosečka
    \textbf{bodově reálná}. V opačném případě je \textbf{formálně reálná}.
\end{definition}

\begin{definition}
    Elipsa, jejíž poloosy mají stejnou velikost, se nazývá \textbf{kružnice}.
\end{definition}

\begin{definition}
    Přímka, podle níž je kuželosečka souměrná, se nazývá její \textbf{osou}.
\end{definition}

\begin{definition}
\textbf{Elipsa} je množina všech bodů v rovině, které mají od dvou různých bodů v rovině,
které se nazývají \textbf{ohniska}, konstantní součet vzdálenosti.
\end{definition}

\begin{priklad}
Určete středovou rovnici elipsy $5x^2+3y^2+20x-24y+38=0.$
\end{priklad}

\begin{reseni}
Doplněním na čtverec.
\end{reseni}

\begin{definition}
\textbf{Hyperbola} je množina všech bodů v rovině, které mají od dvou různých
bodů v rovině, které se nazývají \textbf{ohniska}, konstantní absolutní
hodnotu rozdílu vzdálenosti.
\end{definition}

\begin{priklad}
Je dána hyperbola $k:9x^2-16y^2-36x+32y-124=0.$ Najděte její středovou rovnici,
střed, poloosy, ohniska, vrcholy, rovnice asymptot a hyperbolu načrtněte.
\end{priklad}

\begin{reseni}
Doplníme na čtverec a vydělíme, abychom na pravé straně rovnice měli jedničku.
Zbytek z vlastností hyperboly.
\end{reseni}

\begin{definition}
\textbf{Parabola} je množina všech bodů v rovině, které mají od pevného bodu, který
se nazývá \textbf{ohnisko} a pevné přímky, která se nazývá \textbf{řídící přímka},
na níž tento bod neleží, stejnou vzdálenost.
\end{definition}

\begin{priklad}
Určete vrchol, ohnisko, parametr a řídící přímku paraboly $k:y^2-7x-6y-19=0.$
\end{priklad}

\begin{reseni}
Doplněním na čtverec.
\end{reseni}

\begin{pozn}
    Pro přehled s rovnicemi, obrázky a popisem všech prvků těchto kuželoseček
    viz přílohu \ref{appb}.
\end{pozn}

\begin{definition}
    Přímka, která má s regulární kuželosečkou společný právě jeden bod $T$ a neobsahuje
    žádný bod vnitřní oblasti kuželosečky, se nazývá její \textbf{tečnou} a bod
    $T$ jejím \textbf{bodem dotyku}.
\end{definition}

\begin{definition}
Přímka, která má s regulární kuželosečkou společné právě dva body $T,T^\prime$, se
nazývá její \textbf{sečnou} a úsečka $TT^\prime$ \textbf{tětivou}.
\end{definition}

\begin{veta}
    Nechť \ref{kuzelosec} je obecná rovnice kuželosečky a nechť tečna $t$ této
    kuželosečky se jí dotýká v bodě $T[x_r, y_r].$ Pak tečna $t$ má rovnici
    \begin{equation}\label{kuztec}
        (a_{11}x_r+a_{12}y_r+a_{13})x+(a_{12}x_r+a_{22}y_r+a_{23})y+a_{13}x_r +
        a_{23}y_r+a_{33}=0.
    \end{equation}
\end{veta}

\begin{pozn}
    Rovnici \ref{kuztec} lze zapsat jako
    $$
    \begin{pmatrix}
        x & y & 1
    \end{pmatrix}\cdot A \cdot \begin{pmatrix}
        x_r \\
        y_r \\
        1
    \end{pmatrix}=0.
    $$
\end{pozn}

\begin{veta}[Rovnice tečen regulárních kuželoseček v základní poloze]
    Nechť je dána kuželosečka a její tečna s bodem dotyku $T[x_r,y_r].$ Pak tečna
    má rovnici
    \begin{enumerate}[$i.$]
    \item kružnice se středem v $S[m,n]:(x-m)(x_r-m)+(y-n)(y_r-n)=r^2,$
   	\item elipsa se středem v $S[m,n]:\frac{(x-m)(x_r-m)}{a^2}+\frac{(y-n)(y_r-n)}{b^2}=1$,
   	\item hyperbola se středem $S[m,n]:\frac{(x-m)(x_r-m)}{a^2}-\frac{(y-n)(y_r-n)}{b^2}=1$,
   	\item parabola s vrcholem $V[m,n]:(y-n)(y_r-n)=p(x+x_r-2m).$
    \end{enumerate}
\end{veta}

\begin{priklad}
Napište rovnice tečen ke kuželosečce $x^2+y^2-6x-4y+3=0$ v průsečíku s přímkou $y=x+3$.
\end{priklad}

\begin{reseni}
Nejprve najdeme průsečík $P[p_1,p_2]$ (vyřešíme soustavu těchto dvou rovnic).
Potom má rovnice tečen tvar
$$\begin{pmatrix}
    0 & 3 & 1
\end{pmatrix}\cdot \begin{pmatrix}
    1 & 0 & -3\\
    0 & 1 & -2 \\
    -3 & -2 & 3
\end{pmatrix}\cdot \begin{pmatrix}
    x \\
    y \\
    1
\end{pmatrix}=0.$$
\end{reseni}

\begin{definition}
    Směr v rovině určený vektorem $\vec u(u_1, u_2)\ne \vec o$ nazveme
    \textbf{asymptotickým směrem} kuželosečky o rovnici \ref{kuzelosec}, jestliže
    $$a_{11}u_1^2 + 2a_{12}u_1u_2+a_{22}u_2^2=0.$$
\end{definition}

\begin{priklad}
Určete asymptotické směry kuželosečky $x^2+4xy+y^2-7x-7=0.$
\end{priklad}

\begin{reseni}
Hledáme směr $\vec u(u_1,u_2).$ Po dosazení do rovnice kuželosečky (bereme jen
členy, ve kterých je $x,y$ dvakrát) dostáváme $u_1^2+4u_1u_2+u_2^2=0.$ Zvolíme jednu
z proměnných a rovnici vyřešíme.
\end{reseni}

\begin{definition}
    Bod $S$ je středem kuželosečky $k$ právě tehdy, když $\forall X\in k:\exists X^\prime\in k: S$ je středem $XX^\prime.$
\end{definition}

\begin{veta}
    Bod $S[s_1,s_2]$ je střed kuželosečky o rovnici \ref{kuzelosec} právě tehdy, když
    \begin{align*}
        a_{11}s_1 + a_{12}s_2+a_{13}&=0,\\
        a_{12}s_1 + a_{22}s_2 + a_{23}&=0,
    \end{align*}
\end{veta}

\begin{definition}
    Jestliže střed kuželosečky na ní leží, pak je to \textbf{singulární bod}.
\end{definition}

\begin{priklad}
Určete střed a singulární body kuželosečky $x^2+y^2+2x=0.$
\end{priklad}

\begin{reseni}
Střed kuželosečky vyhovuje rovnici
$$A\cdot \begin{pmatrix}
    s_1 \\
    s_2\\
    0
\end{pmatrix}=0,
$$
kde $A$ je matice dané kuželosečky. Pokud daný bod navíc vyhovuje rovnici
$$A\cdot \begin{pmatrix}
    s_1 \\
    s_2\\
    1
\end{pmatrix}=0,
$$
je to singulární bod.
\end{reseni}

\begin{priklad}
Je dána kuželosečka $y^2-xy-5x+7y+10=0.$ Určete:
\begin{enumerate}[$a.$]
\item zda je regulární / singulární,
\item asymptotické směry,
\item středy,
\item singulární body a
\item druh kuželosečky.
\end{enumerate}
\end{priklad}

\begin{reseni}
Nechť $A$ je matice dané kuželosečky, $\bar{A}$ zmenšená matice kuželosečky, $\vec u=(u_1,u_2)^T, \vec s=(s_1,s_2,0)^T,\vec t=(s_1,s_2,0)^T$.
\begin{enumerate}[$a.$]
\item Spočtením determinantu $A$.
\item Je řešením rovnice $\bar A\vec u=0.$
\item Je řešením rovnice $A\vec s=0.$
\item je řešením rovnice $A\vec t = 0.$
\item Doplněním na čtverec.
\end{enumerate}
\end{reseni}

\begin{definition}
\textbf{Kulová plocha} (resp. \textbf{koule}) se středem $S$ a poloměrem $r>0$ je množina všech bodů v prostoru,
jejichž vzdálenost od $S$ je $r$ (resp. menší nebo rovna $r$).
\end{definition}

\begin{definition}
\textbf{Tečná rovina} kulové plochy je taková rovina, která má s kulovou plochou právě
jeden společný bod.
\end{definition}
